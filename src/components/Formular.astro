---
import Heading from "../components/Heading.astro";
import Text from "../components/Text.astro";
---

<form class="mx-auto max-w-5xl bg-[#D86C6C] lg:rounded-lg p-6 md:px-20 py-15 my-8 md:my-20">
  <Heading size="h3" font="header" stylingclasses="text-center mb-10">
    Submit here!
  </Heading>

  <div class="grid grid-cols-4 md:grid-cols-12 gap-x-10 gap-y-8 font-medium">
    <!-- LEFT: all inputs -->
    <div class="col-span-4 md:col-span-6 space-y-5">
      <!-- Full name -->
      <div>
        <label for="name" class="text-sm">Full name</label>
        <input
          type="text"
          id="name"
          name="name"
          autocomplete="name"
          required
          class="w-full pl-0 border-0 border-b border-black bg-transparent py-0"
        />
      </div>

      <!-- Email -->
      <div>
        <label for="email" class="text-sm">E-mail</label>
        <input
          type="email"
          id="email"
          name="email"
          autocomplete="email"
          required
          class="w-full pl-0 border-0 border-b border-black bg-transparent py-0"
        />
      </div>

      <!-- Submission title -->
      <div>
        <label for="title" class="text-sm">Submission title</label>
        <input
          type="text"
          id="title"
          name="title"
          required
          class="w-full pl-0 border-0 border-b border-black bg-transparent py-0"
        />
      </div>

      <!-- Description -->
      <div>
        <label for="story" class="text-sm">Submission description/story</label>
        <textarea
          id="story"
          name="story"
          rows="2"
          placeholder="Describe the image and how you took it in a sentence or two"
          required
          class="w-full pl-0 border-0 border-b border-t border-black bg-transparent mt-0 py-0 placeholder:text-xs placeholder:text-black"
        ></textarea>
      </div>

      <!-- Terms + Send -->
      <div class="flex items-start gap-3">
        <input id="terms" name="terms" type="checkbox" required class="mt-0" />
        <label for="terms" class="text-xs">
          I have read and agree to the
          <a href="/images/terms.pdf" target="_blank" class="underline text-xs"
            >terms and conditions</a
          >
        </label>
      </div>

      <button
        type="submit"
        class="inline-block mt-2 border-2 rounded-lg border-black px-6 py-2 hover:bg-black hover:text-[#D86C6C] transition-colors duration-300"
      >
        Send
      </button>
    </div>

    <!-- RIGHT: dropzone -->
    <div class="col-span-4 md:col-span-6">
      <div
        id="dropzone"
        class="flex flex-col items-center justify-center gap-3 rounded-lg border-2 border-dashed border-black px-6 py-12 min-h-[360px]"
      >
        <img src="/images/sky.svg" alt="upload" class="w-15 h-15" />
        <p class="text-center text-base">Drag and drop your instant photo here</p>
        <p class="text-center text-xs">or click to browse</p>

        <input
          id="photo"
          name="photo"
          type="file"
          accept="image/*"
          required
          class="hidden"
        />
        <div class="mt-2">
          <button
            id="chooseBtn"
            type="button"
            class="border border-black rounded-lg px-4 py-2"
          >
            Choose File
          </button>
        </div>
        <p id="fileName" class="text-sm"></p>
      </div>
    </div>
  </div>
</form>

<!-- Thank-you modal -->
<div id="thankyou-modal" class="fixed inset-0 hidden">
  <button data-overlay class="absolute inset-0 bg-black/50"></button>

  <div class="min-h-full grid place-items-center p-4">
    <div class="relative max-w-3xl rounded-lg bg-[#F39FA8] p-8 md:p-15">
      <button
        data-close
        aria-label="Close"
        class="absolute right-4 top-3 text-4xl hover:opacity-50"
      >
        ×
      </button>

      <div class="grid grid-cols-1 md:grid-cols-12">
        <div class="md:col-span-9 space-y-5">
          <Heading size="h3" font="header" stylingclasses="mb-10">
            Thanks!
          </Heading>

          <Text teksttype="brødtekst" stylingclasses="text-[10px]">
            You're an instant champ! Thanks for the contribution:-)
          </Text>

          <Text teksttype="brødtekst" stylingclasses="text-[10px]">
            The competition runs until <strong>October 18</strong>. Shortly after,
            we will review all the images, and announce a winner on <strong>October 31</strong>.
          </Text>

          <Text teksttype="brødtekst" stylingclasses="text-[10px]">
            If you're one of the lucky winners or nominees, we will contact you by e-mail.
          </Text>

          <Text teksttype="brødtekst" stylingclasses="text-[10px]">
            Good luck!
          </Text>

          <Text stylingclasses="text-[10px] opacity-80">
            NB! Want to make one more submission? Start the submission form over:-)
          </Text>
        </div>

        <div class="md:col-span-3 flex items-end justify-end">
          <img src="/images/figur.svg" alt="figur" class="max-h-40 md:max-h-48" />
        </div>
      </div>
    </div>
  </div>
</div>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('chooseBtn');
    const input = document.getElementById('photo');
    const fileName = document.getElementById('fileName');
    if (btn && input) {
      btn.addEventListener('click', () => input.click());
      input.addEventListener('change', () => {
        fileName.textContent = input.files?.[0]?.name ?? '';
      });
    }
  });

  // Modal logic
  const form = document.querySelector('form');
  const modal = document.getElementById('thankyou-modal');
  const closeEls = modal.querySelectorAll('[data-close], [data-overlay]');

  function openModal() {
    modal.classList.remove('hidden');
    document.body.classList.add('overflow-hidden');
  }
  function closeModal() {
    modal.classList.add('hidden');
    document.body.classList.remove('overflow-hidden');
  }

  // Vis modal ved submit (bliv på siden)
  form.addEventListener('submit', (e) => {
    e.preventDefault(); // stop navigation
    openModal();
  });

  closeEls.forEach((el) => el.addEventListener('click', closeModal));
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeModal();
  });
</script>  